--- RCPTT testcase ---
Format-Version: 1.0
Contexts: _QPqdkBNIEemmeedSb1JQew,_LkBSkBsDEembU9g-6bJhVg,_jOjx0CCAEem06Mv2pVmYtA,_7pLWIBQVEemEb8FG0wciYA
Element-Name: TarmedFallVerrechnen
Element-Type: testcase
Element-Version: 3.0
External-Reference: 
Id: _gN-zEBNWEemmeedSb1JQew
Runtime-Version: 2.4.1.201903190000
Save-Time: 4/23/19 7:49 PM
Testcase-Type: ecl

------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac
Content-Type: text/ecl
Entry-Name: .content

// requires ImportSwissMediBase and BasicMandanten or demoDB run before
elexisLogMayNotContain "java.lang.OutOfMemoryError"
global [val testPatFamilyName [ concat "Bernasconi-" $defaultLanguage ] ] -override
global [val testPatFirstName "Emil"] -override
global [val test_abr [ concat [ t case_KVG ] "-" $defaultLanguage ] ] -override
concat "TarmedFallVerrechnen " $testPatFirstName " " $testPatFamilyName | log
ChangeMandant [concat [ GetPraxisProperty praxis.mandant.2.Name ] ".*" ]
AbrechnungsSystemKonfigurieren -abrSystem $test_abr -startDate "01.09.2018" -newFactor "0.95" 

OpenAndResetStartPerspektive
AbrechnungsSystemKonfigurieren -abrSystem LaMal -newFactor "0.96" -startDate "01.06.2018"

ChangeMandant [concat [ GetPraxisProperty praxis.mandant.2.Name ] ".*" ]
// Des muss eine Bankverbindung mit einem Kontakt erstellt werden!!

OpenAndResetStartPerspektive

PatientMitFallUndKonsErstellenOderAuswaehlen -familyName $testPatFamilyName -firstName $testPatFirstName -caseName $test_abr

// Items added/checked must be the same in TarmedFallVerrechnen and CheckTarmed Fall
kons-add-complementary 1255
kons-add-tarmed [ concat "10.0010" ] // "Klinische Geruchspr√ºfung, beidseitig" 
kons-add-tarmed [ concat "23.0010" ] // Untersuchung der Mammae KVGSA

kons-add-artikelstamm -item_short Losartan -item_long "LOSARTAN.*7 Stk.*" //7680582930020
kons-add-artikelstamm -item_short Metoprolol -item_long ".*30 Stk.*" //7680591310011

kons-add-block  -blockName "kons plus (KVG)" -expectedItemsAdded 4 // 00.0010 00.0015 00.0026 00.0030

// kons-add-eigenleistung
kons-neue-diagnose [ t kons_diagnose.1.reiter ] [ t kons_diagnose.1.item ]

FallSetVersicherungsNummer -fall $test_abr

AktuellenFallVerrechnen

elexisLogMayNotContain "java.lang.OutOfMemoryError"
// Ende
//
------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac--

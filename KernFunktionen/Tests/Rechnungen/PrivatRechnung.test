--- RCPTT testcase ---
Format-Version: 1.0
Contexts: _LkBSkBsDEembU9g-6bJhVg,_jOjx0CCAEem06Mv2pVmYtA,_QPqdkBNIEemmeedSb1JQew
Element-Name: PrivatRechnung
Element-Type: testcase
Element-Version: 3.0
External-Reference: 
Id: _gAMNcECkEeucZoJXQ1XGtg
Runtime-Version: 2.5.3.202205021448
Save-Time: 7/31/22, 1:52 PM
Testcase-Type: ecl

------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac
Content-Type: text/ecl
Entry-Name: .content

// TODO::
// Kopieren von KonsDirectVerrechnen
// Bank findet man via Raiffeisenbank

TextPluginSelect docx
SetupPrivatrechnung

// Siehe https://redmine.medelexis.ch/issues/17063
// Offener Fall mit Konsultation kann nicht verrechnet werden
ChangeMandant [ GetPraxisProperty praxis.mandant.1.Name ]
// TextPluginSelect hilotec_odf

global [ val privatPatientVorname	"Carlo" ]
global [ val privatPatientName	"PrivatPatient" ]

if [ not [ SelectPatient $privatPatientName $privatPatientVorname] ] {
	PatientenErstellen  $privatPatientName $privatPatientVorname true "30.3.1990" "Nebenstrasse 66" 3340 Elexisdorf "056 323 45 67"
	SelectPatient $privatPatientName $privatPatientVorname -mustExist true
}
let [ val anfangs2022 "30.01.2022" ] [val caseLaw "privat" ] [val caseReason [t reason_KVG]] {
	if [  FallZuPatientExistiert -text [ concat  "privat.*" [ t fall_offen_part ] ".*" ]] {
		log "FallZuPatientExistiert"
	} -else {
		FallZuPatientErstellen -startDate $anfangs2022 -caseLaw $caseLaw -caseReason $caseReason
		FallSetVersicherungsNummer 87654329 -fall [ concat  ".*" $caseLaw ".*"  $anfangs2022 ".*"]
		FallSetCostBearer -name "Helsana Unfall" -printId [concat $privatPatientName " "  $anfangs2022 ]
		FallSetDefaultInvoiceRecipient $privatPatientName $privatPatientVorname
	}
	SelectFall -caseLaw $caseLaw -startDate $anfangs2022
	kons-erstellen [concat $privatPatientName " "  $anfangs2022 " now " [ now ] ] -createSecond true
	kons-set-date $anfangs2022
	kons-add-artikelstamm Nolvadex "Nolvadex.*100 Stk.*"
	kons-neue-diagnose [ t kons_diagnose.1.reiter ] [ t kons_diagnose.1.item ]
}
OpenAndResetStartPerspektive
let [val expectedInvoiceNr [ GetHighestInvoiceNrOf | plus 1  ] ] {
	get-view [t view_cases] | get-table | get-menu -path [t mnu_incoice_case] | click
	RechnungAusgeben -invoiceId $expectedInvoiceNr
}

------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac--

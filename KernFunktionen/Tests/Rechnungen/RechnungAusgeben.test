--- RCPTT testcase ---
Format-Version: 1.0
Element-Name: RechnungAusgeben
Element-Type: testcase
Element-Version: 3.0
External-Reference: 
Id: _DLjaEP4rEeiuqdAcgkHVvQ
Runtime-Version: 2.3.0.201806262310
Save-Time: 12/12/18 5:32 PM
Testcase-Type: ecl

------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac
Content-Type: text/ecl
Entry-Name: .content

with [get-view Konsultation | get-editbox -after [get-label "07.08.2008 (vor 10 Jahren)"]] {
    set-text-offset 0 6
    key-type "M1+n"
}
with [get-window "Sicht anzeigen"] {
    get-tree | select "Abrechnung/Rechnungsliste"
    get-button "Öffnen" | click
}
get-view Konsultation | get-editbox -after [get-label "07.08.2008 (vor 10 Jahren)"] | set-text-offset 0 6
get-view Rechnungsliste | get-tree 
    | select "Absolut Erfunden (w), 18.11.1933/KVG: Krankheit - Allgemein(28.05.2006- offen)/8 12.12.2018: Absolut Erfunden (w), 18.11.1933 85.35" 
    | get-menu -path "Ausgeben..." | click
with [get-window "Rechnung ausgeben"] {
    get-combo | select "Als Tarmed-Rechnung ausdrucken"
    with [get-group "Datei für TrustCenter"] {
        get-button "auch als XML für TrustCenter speichern" | check
        get-editbox | click-text
    }
}
set-dialog-result Folder "/home/niklaus"
with [get-window "Rechnung ausgeben"] {
    get-group "Datei für TrustCenter" | get-button "Verzeichnis:" | click
    get-button OK | click
    get-window Statusinformationen | get-window "Fehler beim Drucken" | get-button OK | click
}
/* Ein Status-Dialog blitzt kurz auf. Keine Rechnung wird erstellt und im Elexis.log findet mant
17:26:40.773 [ModalContext] ERROR ch.elexis.TarmedRechnung.XMLExporter - cvc-pattern-valid: Wert '200011223445' ist nicht Facet-gültig in Bezug auf Muster '([0-9]{13})' für Typ 'eanPartyType'.
cvc-attribute.3: Wert '200011223445' des Attributs 'from' bei Element 'invoice:transport' hat keinen gültigen Typ 'eanPartyType'.
cvc-pattern-valid: Wert '123456' ist nicht Facet-gültig in Bezug auf Muster '01-[1-9][0-9]{0,5}-[0-9]' für Typ '#AnonType_participant_numberesr9Type'.
cvc-attribute.3: Wert '123456' des Attributs 'participant_number' bei Element 'invoice:esr9' hat keinen gültigen Typ 'null'.
cvc-pattern-valid: Wert '0100000085350>999888000000000000010000085+ **FEHLER**>' ist nicht Facet-gültig in Bezug auf Muster '(01[0-9]{11}>[0-9]{16}\+ [0-9]{9}>|042>[0-9]{16}\+ [0-9]{9}>|01[0-9]{11}>[0-9]{27}\+ [0-9]{9}>|042>[0-9]{27}\+ [0-9]{9}>)' für Typ '#AnonType_coding_lineesr9Type'.
cvc-attribute.3: Wert '0100000085350>999888000000000000010000085+ **FEHLER**>' des Attributs 'coding_line' bei Element 'invoice:esr9' hat keinen gültigen Typ 'null'.
cvc-pattern-valid: Wert '200011223445' ist nicht Facet-gültig in Bezug auf Muster '([0-9]{13})' für Typ 'eanPartyType'.
cvc-attribute.3: Wert '200011223445' des Attributs 'ean_party' bei Element 'invoice:biller' hat keinen gültigen Typ 'eanPartyType'.
cvc-pattern-valid: Wert '200011223445' ist nicht Facet-gültig in Bezug auf Muster '([0-9]{13})' für Typ 'eanPartyType'.
cvc-attribute.3: Wert '200011223445' des Attributs 'ean_party' bei Element 'invoice:provider' hat keinen gültigen Typ 'eanPartyType'.
cvc-datatype-valid.1.2.3: '200011223445' ist kein gültiger Wert des Vereinigungsmengentyps 'unionPartyType'.
cvc-attribute.3: Wert '200011223445' des Attributs 'provider_id' bei Element 'invoice:record_drug' hat keinen gültigen Typ 'unionPartyType'.
cvc-datatype-valid.1.2.3: '200011223445' ist kein gültiger Wert des Vereinigungsmengentyps 'unionPartyType'.
cvc-attribute.3: Wert '200011223445' des Attributs 'responsible_id' bei Element 'invoice:record_drug' hat keinen gültigen Typ 'unionPartyType'.
cvc-datatype-valid.1.2.3: '200011223445' ist kein gültiger Wert des Vereinigungsmengentyps 'unionPartyType'.
cvc-attribute.3: Wert '200011223445' des Attributs 'provider_id' bei Element 'invoice:record_drug' hat keinen gültigen Typ 'unionPartyType'.
cvc-datatype-valid.1.2.3: '200011223445' ist kein gültiger Wert des Vereinigungsmengentyps 'unionPartyType'.
cvc-attribute.3: Wert '200011223445' des Attributs 'responsible_id' bei Element 'invoice:record_drug' hat keinen gültigen Typ 'unionPartyType'.
cvc-datatype-valid.1.2.3: '200011223445' ist kein gültiger Wert des Vereinigungsmengentyps 'unionPartyType'.
cvc-attribute.3: Wert '200011223445' des Attributs 'provider_id' bei Element 'invoice:record_drug' hat keinen gültigen Typ 'unionPartyType'.
cvc-datatype-valid.1.2.3: '200011223445' ist kein gültiger Wert des Vereinigungsmengentyps 'unionPartyType'.
cvc-attribute.3: Wert '200011223445' des Attributs 'responsible_id' bei Element 'invoice:record_drug' hat keinen gültigen Typ 'unionPartyType'.

17:26:40.778 [ModalContext] DEBUG ch.elexis.TarmedRechnung.XMLExporter - <?xml version="1.0" encoding="UTF-8"?>
<invoice:request xmlns:invoice="http://www.forum-datenaustausch.ch/invoice" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:nsxenc="http://www.w3.org/2001/04/xmlenc#" xsi:schemaLocation="http://www.forum-datenaustausch.ch/invoice generalInvoiceRequest_440.xsd" modus="production" language="de">
  <invoice:processing print_at_intermediate="1">
    <invoice:transport from="200011223445" to="2000000000001">
      <invoice:via via="7601001370128" sequence_id="1" />
    </invoice:transport>
    <invoice:demand tc_demand_id="0" tc_token="6900000085353&gt;999888000000000000010000085+ **FEHLER**&gt;" insurance_demand_date="2018-12-12T00:00:00" />
  </invoice:processing>
  <invoice:payload type="invoice" copy="1" storno="0">
    <invoice:invoice request_timestamp="1544631931" request_id="000001000008" request_date="2018-12-12T17:26:39" />
    <invoice:body role="physician" place="practice">
      <invoice:prolog>
        <invoice:package version="380" name="Elexis" />
        <invoice:generator name="JDOM" version="100">
          <invoice:depends_on name="Elexis TarmedVerifier" version="380" />
        </invoice:generator>
      </invoice:prolog>
      <invoice:balance currency="CHF" amount_prepaid="0.00" amount="85.35" amount_due="85.35" amount_obligations="85.35">
        <invoice:vat vat="0.00">
          <invoice:vat_rate vat_rate="0.00" amount="85.35" vat="0.00" />
        </invoice:vat>
      </invoice:balance>
      <invoice:esr9 participant_number="123456" type="16or27" reference_number="99 98880 00000 00000 00100 00085" coding_line="0100000085350&gt;999888000000000000010000085+ **FEHLER**&gt;">
        <invoice:bank>
          <invoice:company>
            <invoice:companyname>Raiffeisenbank Elexikon</invoice:companyname>
            <invoice:postal>
              <invoice:street>Oberdorf 27</invoice:street>
              <invoice:zip countrycode="CH">9999</invoice:zip>
              <invoice:city>Elexikon</invoice:city>
            </invoice:postal>
          </invoice:company>
        </invoice:bank>
      </invoice:esr9>
      <invoice:tiers_garant payment_period="P30D">
        <invoice:biller ean_party="200011223445" zsr="G123345" specialty="Innere Medizin">
          <invoice:person salutation="Herrn">
            <invoice:familyname>Dr. Test</invoice:familyname>
            <invoice:givenname>Alfred</invoice:givenname>
            <invoice:postal>
              <invoice:pobox>17</invoice:pobox>
              <invoice:street>Neustadt 27</invoice:street>
              <invoice:zip countrycode="CH">9999</invoice:zip>
              <invoice:city>Elexikon</invoice:city>
            </invoice:postal>
            <invoice:telecom>
              <invoice:phone>052 555 22 33</invoice:phone>
            </invoice:telecom>
            <invoice:online>
              <invoice:email>Test@elexis.ch</invoice:email>
              <invoice:url>http://www.elexis.ch</invoice:url>
            </invoice:online>
          </invoice:person>
        </invoice:biller>
        <invoice:provider ean_party="200011223445" zsr="G123345" specialty="Innere Medizin">
          <invoice:person salutation="Herrn">
            <invoice:familyname>Dr. Test</invoice:familyname>
            <invoice:givenname>Alfred</invoice:givenname>
            <invoice:postal>
              <invoice:pobox>17</invoice:pobox>
              <invoice:street>Neustadt 27</invoice:street>
              <invoice:zip countrycode="CH">9999</invoice:zip>
              <invoice:city>Elexikon</invoice:city>
            </invoice:postal>
            <invoice:telecom>
              <invoice:phone>052 555 22 33</invoice:phone>
            </invoice:telecom>
            <invoice:online>
              <invoice:email>Test@elexis.ch</invoice:email>
              <invoice:url>http://www.elexis.ch</invoice:url>
            </invoice:online>
          </invoice:person>
        </invoice:provider>
        <invoice:insurance ean_party="2000000000001">
          <invoice:company>
            <invoice:companyname>Allgemeine Krankenkasse</invoice:companyname>
            <invoice:postal>
              <invoice:street>Hauptplatz 1</invoice:street>
              <invoice:zip>9999</invoice:zip>
              <invoice:city>Elexikon</invoice:city>
            </invoice:postal>
          </invoice:company>
        </invoice:insurance>
        <invoice:patient gender="female" birthdate="1933-11-18T00:00:00">
          <invoice:person>
            <invoice:familyname>Absolut</invoice:familyname>
            <invoice:givenname>Erfunden</invoice:givenname>
            <invoice:postal>
              <invoice:street>Andere Seite 2</invoice:street>
              <invoice:zip countrycode="CH">9997</invoice:zip>
              <invoice:city>Andernorts</invoice:city>
            </invoice:postal>
          </invoice:person>
        </invoice:patient>
        <invoice:guarantor>
          <invoice:person>
            <invoice:familyname>Absolut</invoice:familyname>
            <invoice:givenname>Erfunden</invoice:givenname>
            <invoice:postal>
              <invoice:street>Andere Seite 2</invoice:street>
              <invoice:zip countrycode="CH">9997</invoice:zip>
              <invoice:city>Andernorts</invoice:city>
            </invoice:postal>
          </invoice:person>
        </invoice:guarantor>
      </invoice:tiers_garant>
      <invoice:kvg insured_id="123456" case_date="2018-12-12T00:00:00" />
      <invoice:treatment date_begin="2018-12-12T00:00:00" date_end="2018-12-12T00:00:00" canton="SH" reason="disease">
        <invoice:diagnosis type="by_contract" code="A1" />
      </invoice:treatment>
      <invoice:services>
        <invoice:record_drug unit="20.80" unit_factor="1.00" tariff_type="402" code="7680193950301" amount="20.80" vat_rate="0.0" obligation="true" validate="true" provider_id="200011223445" responsible_id="200011223445" session="2" record_id="1" quantity="1.0" date_begin="2018-12-12T00:00:00" name="MARCOUMAR Tabl 3 mg Fl 100 Stk" />
        <invoice:record_drug unit="58.05" unit_factor="1.00" tariff_type="402" code="7680390530474" amount="58.05" vat_rate="0.0" obligation="true" validate="true" provider_id="200011223445" responsible_id="200011223445" session="2" record_id="2" quantity="1.0" date_begin="2018-12-12T00:00:00" name="NOLVADEX Tabl 20 mg 100 Stk" />
        <invoice:record_drug unit="6.50" unit_factor="1.00" tariff_type="402" code="7680517950680" amount="6.50" vat_rate="0.0" obligation="true" validate="true" provider_id="200011223445" responsible_id="200011223445" session="2" record_id="3" quantity="1.0" date_begin="2018-12-12T00:00:00" name="ASPIRIN CARDIO Filmtabl 100 mg 28 Stk" />
      </invoice:services>
    </invoice:body>
  </invoice:payload>
</invoice:request>

*/
------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac--
